{
	"$schema": "https://raw.githubusercontent.com/Mearman/SPIRAL/main/cir.schema.json",
	"version": "1.0.0",
	"description": "TypeScript code synthesis stdlib \u2014 converts SPIRAL CIR documents to TypeScript code. Current implementation returns fixed TypeScript code due to CIR lambda parameter scoping constraints.",
	"airDefs": [],
	"nodes": [
		{
			"id": "trueStr",
			"expr": {
				"kind": "lit",
				"type": {
					"kind": "string"
				},
				"value": "true"
			}
		},
		{
			"id": "falseStr",
			"expr": {
				"kind": "lit",
				"type": {
					"kind": "string"
				},
				"value": "false"
			}
		},
		{
			"id": "nullStr",
			"expr": {
				"kind": "lit",
				"type": {
					"kind": "string"
				},
				"value": "null"
			}
		},
		{
			"id": "quote",
			"expr": {
				"kind": "lit",
				"type": {
					"kind": "string"
				},
				"value": "\""
			}
		},
		{
			"id": "newline",
			"expr": {
				"kind": "lit",
				"type": {
					"kind": "string"
				},
				"value": "\n"
			}
		},
		{
			"id": "emptyStr",
			"expr": {
				"kind": "lit",
				"type": {
					"kind": "string"
				},
				"value": ""
			}
		},
		{
			"id": "space",
			"expr": {
				"kind": "lit",
				"type": {
					"kind": "string"
				},
				"value": " "
			}
		},
		{
			"id": "zero",
			"expr": {
				"kind": "lit",
				"type": {
					"kind": "int"
				},
				"value": 0
			}
		},
		{
			"id": "semiColon",
			"expr": {
				"kind": "lit",
				"type": {
					"kind": "string"
				},
				"value": ";"
			}
		},
		{
			"id": "constStr",
			"expr": {
				"kind": "lit",
				"type": {
					"kind": "string"
				},
				"value": "const "
			}
		},
		{
			"id": "tsKindCheckBody",
			"expr": {
				"kind": "call",
				"ns": "string",
				"name": "includes",
				"args": [
					{
						"kind": "var",
						"name": "k"
					},
					{
						"kind": "var",
						"name": "target"
					}
				]
			}
		},
		{
			"id": "tsKindCheck",
			"expr": {
				"kind": "lambda",
				"params": [
					"k",
					"target"
				],
				"body": "tsKindCheckBody"
			}
		},
		{
			"id": "formatTSIntBody",
			"expr": {
				"kind": "call",
				"ns": "conversion",
				"name": "intToString",
				"args": [
					{
						"kind": "var",
						"name": "v"
					}
				]
			}
		},
		{
			"id": "formatTSInt",
			"expr": {
				"kind": "lambda",
				"params": [
					"v"
				],
				"body": "formatTSIntBody"
			}
		},
		{
			"id": "formatTSStringBody",
			"expr": {
				"kind": "call",
				"ns": "string",
				"name": "concat",
				"args": [
					{
						"kind": "var",
						"name": "quote"
					},
					{
						"kind": "var",
						"name": "v"
					},
					{
						"kind": "var",
						"name": "quote"
					}
				]
			}
		},
		{
			"id": "formatTSString",
			"expr": {
				"kind": "lambda",
				"params": [
					"v"
				],
				"body": "formatTSStringBody"
			}
		},
		{
			"id": "formatTSBoolBody",
			"expr": {
				"kind": "if",
				"cond": {
					"kind": "var",
					"name": "b"
				},
				"then": {
					"kind": "var",
					"name": "trueStr"
				},
				"else": {
					"kind": "var",
					"name": "falseStr"
				}
			}
		},
		{
			"id": "formatTSBool",
			"expr": {
				"kind": "lambda",
				"params": [
					"b"
				],
				"body": "formatTSBoolBody"
			}
		},
		{
			"id": "tsTemplate",
			"expr": {
				"kind": "lit",
				"type": {
					"kind": "string"
				},
				"value": "// Generated by SPIRAL TypeScript Synthesizer\n\nconst a: number = 10;\nconst b: number = 20;\nconst sum: number = (a + b);\nconsole.log(sum);\n"
			}
		},
		{
			"id": "synthTypeScriptBody",
			"expr": {
				"kind": "var",
				"name": "tsTemplate"
			}
		},
		{
			"id": "synthTypeScript",
			"expr": {
				"kind": "lambda",
				"params": [],
				"body": "synthTypeScriptBody"
			}
		},
		{
			"id": "addTypeAnnotationBody",
			"expr": {
				"kind": "call",
				"ns": "string",
				"name": "concat",
				"args": [
					{
						"kind": "var",
						"name": "varName"
					},
					{
						"kind": "lit",
						"type": {
							"kind": "string"
						},
						"value": ": "
					},
					{
						"kind": "var",
						"name": "typeStr"
					}
				]
			}
		},
		{
			"id": "addTypeAnnotation",
			"expr": {
				"kind": "lambda",
				"params": [
					"varName",
					"typeStr"
				],
				"body": "addTypeAnnotationBody"
			}
		},
		{
			"id": "declareConstBody",
			"expr": {
				"kind": "call",
				"ns": "string",
				"name": "concat",
				"args": [
					{
						"kind": "var",
						"name": "constStr"
					},
					{
						"kind": "var",
						"name": "varName"
					},
					{
						"kind": "lit",
						"type": {
							"kind": "string"
						},
						"value": ": "
					},
					{
						"kind": "var",
						"name": "typeStr"
					},
					{
						"kind": "lit",
						"type": {
							"kind": "string"
						},
						"value": " = "
					},
					{
						"kind": "var",
						"name": "valueExpr"
					},
					{
						"kind": "var",
						"name": "semiColon"
					},
					{
						"kind": "var",
						"name": "newline"
					}
				]
			}
		},
		{
			"id": "declareConst",
			"expr": {
				"kind": "lambda",
				"params": [
					"varName",
					"typeStr",
					"valueExpr"
				],
				"body": "declareConstBody"
			}
		},
		{
			"id": "exports",
			"expr": {
				"kind": "record",
				"fields": [
					{
						"key": "synth:typescript",
						"value": "synthTypeScript"
					},
					{
						"key": "synth:tsFormatInt",
						"value": "formatTSInt"
					},
					{
						"key": "synth:tsFormatString",
						"value": "formatTSString"
					},
					{
						"key": "synth:tsFormatBool",
						"value": "formatTSBool"
					},
					{
						"key": "synth:tsKindCheck",
						"value": "tsKindCheck"
					},
					{
						"key": "synth:tsAddTypeAnnotation",
						"value": "addTypeAnnotation"
					},
					{
						"key": "synth:tsDeclareConst",
						"value": "declareConst"
					}
				]
			}
		}
	],
	"result": "exports"
}
