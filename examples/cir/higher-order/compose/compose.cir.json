{
	"$schema": "https://raw.githubusercontent.com/Mearman/SPIRAL/main/cir.schema.json",
	"version": "1.0.0",
	"airDefs": [
		{
			"ns": "core",
			"name": "mul",
			"params": [
				"a",
				"b"
			],
			"result": {
				"kind": "int"
			},
			"body": {
				"kind": "ref",
				"id": "a"
			}
		},
		{
			"ns": "core",
			"name": "add",
			"params": [
				"a",
				"b"
			],
			"result": {
				"kind": "int"
			},
			"body": {
				"kind": "ref",
				"id": "a"
			}
		}
	],
	"nodes": [
		{
			"id": "five",
			"expr": {
				"kind": "lit",
				"type": {
					"kind": "int"
				},
				"value": 5
			}
		},
		{
			"id": "two",
			"expr": {
				"kind": "lit",
				"type": {
					"kind": "int"
				},
				"value": 2
			}
		},
		{
			"id": "one",
			"expr": {
				"kind": "lit",
				"type": {
					"kind": "int"
				},
				"value": 1
			}
		},
		{
			"id": "mul2",
			"expr": {
				"kind": "lambda",
				"type": {
					"kind": "fn",
					"params": [
						{
							"kind": "int"
						}
					],
					"returns": {
						"kind": "int"
					}
				},
				"params": [
					"x"
				],
				"body": "mul2Body"
			}
		},
		{
			"id": "mul2Body",
			"expr": {
				"kind": "call",
				"ns": "core",
				"name": "mul",
				"args": [
					"x",
					"two"
				]
			}
		},
		{
			"id": "add1",
			"expr": {
				"kind": "lambda",
				"type": {
					"kind": "fn",
					"params": [
						{
							"kind": "int"
						}
					],
					"returns": {
						"kind": "int"
					}
				},
				"params": [
					"x"
				],
				"body": "add1Body"
			}
		},
		{
			"id": "add1Body",
			"expr": {
				"kind": "call",
				"ns": "core",
				"name": "add",
				"args": [
					"x",
					"one"
				]
			}
		},
		{
			"id": "compose",
			"expr": {
				"kind": "lambda",
				"type": {
					"kind": "fn",
					"params": [
						{
							"kind": "fn",
							"params": [
								{
									"kind": "int"
								}
							],
							"returns": {
								"kind": "int"
							}
						},
						{
							"kind": "fn",
							"params": [
								{
									"kind": "int"
								}
							],
							"returns": {
								"kind": "int"
							}
						}
					],
					"returns": {
						"kind": "fn",
						"params": [
							{
								"kind": "int"
							}
						],
						"returns": {
							"kind": "int"
						}
					}
				},
				"params": [
					"f",
					"g"
				],
				"body": "composeBody"
			}
		},
		{
			"id": "composeBody",
			"expr": {
				"kind": "lambda",
				"type": {
					"kind": "fn",
					"params": [
						{
							"kind": "int"
						}
					],
					"returns": {
						"kind": "int"
					}
				},
				"params": [
					"x"
				],
				"body": "composeInnerBody"
			}
		},
		{
			"id": "gx",
			"expr": {
				"kind": "callExpr",
				"args": [
					"x"
				],
				"fn": "g"
			}
		},
		{
			"id": "composeInnerBody",
			"expr": {
				"kind": "callExpr",
				"args": [
					"gx"
				],
				"fn": "f"
			}
		},
		{
			"id": "composeAdd1Mul2",
			"expr": {
				"kind": "callExpr",
				"args": [
					"add1",
					"mul2"
				],
				"fn": "compose"
			}
		},
		{
			"id": "result",
			"expr": {
				"kind": "callExpr",
				"args": [
					"five"
				],
				"fn": "composeAdd1Mul2"
			}
		}
	],
	"result": "result",
	"expected_result": 11
}
